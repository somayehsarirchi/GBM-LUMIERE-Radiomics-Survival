[![DOI](https://zenodo.org/badge/1107499481.svg)](https://doi.org/10.5281/zenodo.17818439)

üìò GBM-LUMIERE-Radiomics-Survival

# Longitudinal FLAIR Radiomics and Survival in the LUMIERE Cohort

## üìÑ Commercial Case Study

Independent outcome-driven re-analysis of the LUMIERE longitudinal glioblastoma cohort.

Demonstrates conversion of longitudinal MRI radiomics into interpretable prognostic biomarkers and patient risk stratification.

‚û° [Download Case Study PDF](case_study/CaseStudy1_LUMIERE_Longitudinal_GBM_Radiomics.pdf)



> **Longitudinal FLAIR Radiomics and Survival in the LUMIERE Cohort**

based on the public **LUMIERE** dataset:

- Yannick Suter (2022).  
  *The LUMIERE Dataset: Longitudinal Glioblastoma MRI with Expert RANO Evaluation.*  
  Figshare. https://doi.org/10.6084/m9.figshare.c.5904905.v1

The main goal is to build and evaluate parsimonious Cox proportional hazards models
using longitudinal FLAIR-derived radiomics features and clinical variables, and to
assess time-dependent discrimination and calibration (C-index, Brier score, IBS).This repository accompanies the manuscript ‚ÄòLongitudinal FLAIR radiomics and survival in the LUMIERE cohort‚Äô (Sarirchi et al., under review).

---

## Repository structure

```text
.
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ LUMIERE-survival-report.Rmd     # Main R Markdown report
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ 01_preprocess_to_TD_FINAL.R # From raw LUMIERE CSVs to survival-ready TD dataset
‚îÇ   ‚îú‚îÄ‚îÄ 02_run_survival_models.R    # Fits Cox models and saves intermediate objects
‚îÇ   ‚îú‚îÄ‚îÄ 03_plot_results.R           # Generates figures (C-index, Brier, KM, heatmaps)
‚îÇ   ‚îú‚îÄ‚îÄ 04_export_results.R         # (optional) Export summary tables, metrics
‚îÇ   ‚îî‚îÄ‚îÄ 05_render_report.R          # (optional) Renders the Rmd report programmatically
‚îú‚îÄ‚îÄ data/                           # Raw and derived data (NOT tracked in Git)
‚îÇ   ‚îî‚îÄ‚îÄ README_data.md              # Instructions for obtaining the LUMIERE CSV files
‚îú‚îÄ‚îÄ results/                        # Auto-generated results (figures, RDS, CSV; Git-ignored)
‚îî‚îÄ‚îÄ .gitignore

    Important:
    Raw data and all derived CSV/RDS/PNG files are not tracked in this repository.
    They are generated on the fly by the scripts in scripts/.

Data availability

The original LUMIERE data are available from Figshare:

    https://doi.org/10.6084/m9.figshare.c.5904905.v1

After downloading the CSV files, place them into the data/ directory, e.g.:

data/
  LUMIERE-Demographics_Pathology.csv
  LUMIERE-ExpertRating-v202211.csv
  LUMIERE-MRinfo.csv
  LUMIERE-pyradiomics-deepbratumia-features.csv

The survival-ready time-dependent dataset used in this report is:

data/LUMIERE_TD_FINAL.csv

This file is generated by the preprocessing script
scripts/01_preprocess_to_TD_FINAL.R and therefore is not tracked in Git.
Reproducible workflow

Once the raw LUMIERE CSV files are in data/, the complete analysis can be
reproduced using the following steps in R.
1Ô∏è‚É£ Preprocessing: from raw CSVs to survival-ready dataset

source("scripts/01_preprocess_to_TD_FINAL.R")

This script produces:

    data/LUMIERE_TD_FINAL.csv: a time-dependent dataset with
    Surv(start, stop, event) information, clinical covariates, and radiomics features.

2Ô∏è‚É£ Fit Cox models and save intermediate objects

source("scripts/02_run_survival_models.R")

This script:

    Loads data/LUMIERE_TD_FINAL.csv

    Prepares a complete-case evaluation dataset

    Fits:

        model_final: Cox model on the full TD dataset

        model_cc: Cox model on complete cases

    Computes:

        Evaluation times (quartiles of follow-up)

        Time grids for C-index and Brier curves

    Saves all objects to results/ as .rds

3Ô∏è‚É£ Generate all figures

source("scripts/03_plot_results.R")

This script:

    Loads the .rds objects from results/

    Produces all figures used in the report, including:

        Radiomics correlation heatmaps

        Overall Kaplan‚ÄìMeier survival curve

        KM curves by RANO response (Rating3)

        Time-dependent C-index curves (apparent and bootstrap .632)

        Brier score / prediction error curves (apparent and bootstrap .632+)

        Risk-group stratified KM curves based on the Cox linear predictor

    Saves the figures as .png files in results/.

4Ô∏è‚É£ Render the R Markdown report (optional)

You can knit the Rmd manually in RStudio, or use a wrapper script such as:

rmarkdown::render("LUMIERE-survival-report.Rmd")

or

source("scripts/05_render_report.R")

Software requirements

    R ‚â• 4.3 (tested with R 4.4+)

    Suggested packages:

install.packages(c(
  "tidyverse",
  "stringr",
  "readr",
  "survival",
  "survminer",
  "caret",
  "pheatmap",
  "corrplot",
  "riskRegression",
  "pec",
  "here"
))

Notes on reproducibility

    All analysis steps are scripted and documented.

    Raw data are not shipped in this repository due to size and licensing;
    they must be obtained from the original Figshare record.

    All figures and metrics in the report can be regenerated by running the
    scripts described above.

    Only source code and documentation are version-controlled; all
    auto-generated artifacts in results/ are intentionally excluded from Git.

üôå 9. Citation

If you use this repository in academic work, please cite:

Sarirchi S. (2025). GBM-LUMIERE-Radiomics-Survival: 
Time-dependent survival modeling with longitudinal radiomics.
GitHub repository: https://github.com/somayehsarirchi/GBM-LUMIERE-Radiomics-Survival (https://doi.org/10.5281/zenodo.17818439)
